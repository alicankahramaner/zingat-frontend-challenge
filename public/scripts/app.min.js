var App={Init:function(){App.Helper.Import(this)},Helper:{Import:function(e){var t;for(t in e)if(e.hasOwnProperty(t)){var l=e[t];void 0!==l.selector&&void 0!==l.init&&document.querySelectorAll(l.selector).length&&l.init()}},isMobile:()=>window.innerWidth<960,Http:(()=>{var e=new XMLHttpRequest,t=document.getElementById("loading"),l=async(l="POST",i="",a={},s=Function)=>new Promise((s,n)=>{t.classList.toggle("show"),e.open("POST",i,!0),"POST"===l&&e.setRequestHeader("Content-Type","application/json"),e.onreadystatechange=function(){4==this.readyState&&200==this.status&&(t.classList.toggle("show"),s(JSON.parse(e.responseText)))},e.onerror=n,e.send(JSON.stringify(a))});return{post:async(e="",t={})=>await l("POST",e,t),get:async(e="",t={})=>await l("GET",e,t)}})()},Login:{selector:".login-form",init(){var e=document.querySelector(this.selector);e.addEventListener("submit",async function(t){t.preventDefault();var l={username:e.elements.username.value,password:e.elements.password.value};if(""===l.username||""===l.password)return void alert("Lütfen bütün alanları doldurunuz.");(await App.Helper.Http.post("/login",l)).success?location.href="/myalbums":alert("Hatalı kullanıcı adı veya şifre")})}},MyAlbums:{selector:"#myalbums",albumLinkList:document.getElementById("albumList"),albumImages:document.getElementById("albumImages"),previewAlbumImage:previewAlbumImage=document.getElementById("previewAlbumImage"),init(){this.getAlbumList()},async getAlbumList(){let e=await App.Helper.Http.post("/myalbums",{size:10});e.success?this.fillAlbumList(e.data):alert("Albümler getirilemedi tekrar deneyiniz.")},fillAlbumList(e=[]){for(var t=0;t<e.length;t++){let l=e[t],i=document.createElement("a");i.text=l.title,i.href="javascript:;",i.onclick=(e=>{this.getAlbumDetail(e,l.id)}),this.albumLinkList.appendChild(i)}},async getAlbumDetail(e,t=0){if(0===t)return;let l=this.albumLinkList.querySelector(".active");l&&l.classList.remove("active"),e.target.classList.add("active");let i=await App.Helper.Http.post("/getAlbum",{albumId:t,size:App.Helper.isMobile()?4:8});i.success?this.fillAlbumImage(i.data):alert("Bir hata oluştu lütfen tekrar deneyiniz.")},fillAlbumImage(e=[]){this.albumImages.innerHTML="",e.forEach(e=>{let t=document.createElement("img");t.src=e.thumbnailUrl,t.alt=e.title,t.dataset.fullsize=e.url,t.onclick=(t=>{this.getAlbumPhotoFullSize(e.url)}),this.albumImages.appendChild(t)})},getAlbumPhotoFullSize(e=""){if(""===e)return;let t=this.previewAlbumImage.querySelector("img");t||(t=document.createElement("img"),this.previewAlbumImage.appendChild(t)),t.src=e}}};window.addEventListener("load",()=>{App.Init()});